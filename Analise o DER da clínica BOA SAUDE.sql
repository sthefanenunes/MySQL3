Analise o DER da clínica BOA SAUDE

CREATE DATABASE CLINICA_BOA_SAUDE;

/*USAR O BANCO DE DADOS*/
USE CLINICA_BOA_SAUDE;

SHOW TABLES;

CREATE TABLE IF NOT EXISTS PACIENTE(
    CODPAC INT AUTO_INCREMENT,
    NOME VARCHAR(45),
    ENDERECO VARCHAR(80),
    TELEFONE VARCHAR (15),
    /*CRIAR O IDENTIFICADOR CHAVE*/
    CONSTRAINT PK_PACIENTE_CODPAC PRIMARY KEY(CODPAC)
)

/*TABELA MEDICO*/
CREATE TABLE IF NOT EXISTS MEDICO(
    CRM INT,
    NOME VARCHAR(45),
    ENDERECO VARCHAR(80),
    TELEFONE VARCHAR(15),
    ESPECIALIDADE VARCHAR(40),
    /*CRIANDO O IDENTIFICADOR CHAVE*/
    CONSTRAINT PK_MEDICO_CRM PRIMARY KEY(CRM)
);

/*TABELA CONVENIO*/
CREATE TABLE IF NOT EXISTS CONVENIO(
    CODCONV INTEGER,
    NOME VARCHAR(20),
    /*CRIANDO O IDENTIFICADOR CHAVE*/
    CONSTRAINT PK_CONVENIO_CODCONV PRIMARY KEY(CODCONV)
)


/*TABELA CONSULTA*/
CREATE TABLE IF NOT EXISTS CONSULTA(
    CODCONSULTA INT AUTO_INCREMENT,
    DATAA VARCHAR(10),
    HORARIO VARCHAR (10),
    MEDICO INT, /*RECEBER A CHAVE CRM DA TABELA MEDICO*/
    PACIENTE INT, /*RECEBER A CHAVE CODPAC DA TABELA PACIENTE*/
    CONVENIO INT, /*RECEBER A CHAVE CODCONV DA TABELA CONVENIO*/
    PENCENT FLOAT, /*CRIA O IDENTIFICADOR CHAVE PRIMARIA*/
    CONSTRAINT PK_CONSULTA_CODCONSULTA PRIMARY KEY (CODCONSULTA),
    /*CRIANDO O IDENTIFICADORES CHAVES ESTRANGEIRAS*/
    CONSTRAINT FK_CONSULTA_MEDICO_CRM FOREIGN KEY(MEDICO)REFERENCES MEDICO(CRM),
    CONSTRAINT FK_CONSULTA_PACIENTE_CODPAC FOREIGN KEY(PACIENTE)REFERENCES PACIENTE(CODPAC),
    CONSTRAINT FK_CONSULTA_CONVENIO_CODCONV FOREIGN KEY(CONVENIO)REFERENCES CONVENIO(CODCONV)
)
DROP TABLE CONSULTA
/*TABELA ATENDENTE*/
CREATE TABLE IF NOT EXISTS ATENDE(
    MEDICO INT,
    CONVENIO INT,
    /*CHAVE PRIMARIA*/
    CONSTRAINT PK_ATENDE PRIMARY KEY(MEDICO, CONVENIO),
    /*CHAVES ESTRANGEIRAS*/
    CONSTRAINT FK_ATENDE_MEDICO_CRM FOREIGN KEY(MEDICO) REFERENCES MEDICO (CRM),
    CONSTRAINT FK_ATENDE_CONVENIO_CODCONV FOREIGN KEY(CONVENIO) REFERENCES CONVENIO (CODCONV)
)

/*TABELA POSSUI*/
CREATE TABLE IF NOT EXISTS POSSUI(
    PACIENTE INT,
    CONVENIO INT,
    TIPO CHAR (2),
    VENCIMENTO VARCHAR(20),
    /*CHAVE PRIMARIA*/
    CONSTRAINT PK_POSSUI_PACIENTE_CONVENIO PRIMARY KEY(PACIENTE, CONVENIO),
    /*CHAVES ESTRANGEIRAS*/
    CONSTRAINT FK_POSSUI_PACIENTE_CODPAC FOREIGN KEY(PACIENTE) REFERENCES PACIENTE (CODPAC),
    CONSTRAINT FK_POSSUI_CONVENIO_CODCONV FOREIGN KEY(CONVENIO) REFERENCES CONVENIO (CODCONV)
)

INSERT INTO PACIENTE (nome, ENDERECO, TELEFONE) VALUES
    ('João','Rua 1','9809-9756' ),
    ('José', 'Rua B','3621-8978'),
    ('Maria','Rua 10','4567-9872'),
    ('Joana','Rua J','3343-9889')

INSERT INTO medico(crm, nome, endereco, telefone, especialidade) VALUES
(18739, 'Elias', 'Rua X', '8738-1221', 'Pediatria'),
(7646, 'Ana', 'Av Z', '7829-1233', 'Obstetricia'),
(39872, 'Pedro', 'Tv H', '9888-2333', 'Oftalmologia')

INSERT INTO CONVENIO(codconv, nome) VALUES
(189, 'Cassi'),
(232, 'Unimed'),
(454, 'Santa Casa'),
(908, 'Copasa'),
(435, 'São Lucas')

INSERT INTO consulta(dataa, horario, medico, paciente, convenio, PENCENT) VALUES
('10/05/2013', '10:00', 18739, 1, 189,'5'),
('12/05/2013', '10:00', 7646, 2, 232,'10'),
('12/05/2013', '11:00', 18739, 3, 908,'15'),
('13/05/2013', '10:00', 7646, 4, 435,'13'),
('14/05/2013', '13:00', 7646, 2, 232,'10'),
('14/05/2013', '14:00', 39872, 1, 189,'5')

INSERT INTO possui(paciente, convenio,tipo, vencimento) VALUES
(1,189,'E', '31/12/2016'),
(2,232,'S', '31/12/2014'),
(3,908,'S', '31/12/2017'),
(4,232,'E', '31/12/2016'),
(1,232, 'S', '31/12/2015')

/*CONSULTA SOLICITADA NO PDF*/

UPDATE Paciente SET Endereco = 'Rua do Bonde' WHERE Nome = 'João';

UPDATE medico SET Endereco = 'Rua z' WHERE Nome = 'Elias';

update possui set tipo="S" where tipo != "S" ;

DELETE FROM POSSUI
WHERE PACIENTE = (SELECT CODPAC FROM PACIENTE WHERE NOME = 'José') AND CONVENIO = 232;


DELETE FROM CONSULTA WHERE DATAA = '14/05/2013' AND HORARIO = '14:00';

ALTER TABLE MEDICO
CHANGE COLUMN especialidade especializacao VARCHAR(40);

ALTER TABLE CONVENIO
MODIFY COLUMN NOME VARCHAR(200);

ALTER TABLE CONSULTA
ADD COLUMN Valor DECIMAL(10, 2);

UPDATE CONSULTA
SET Valor = 100.00;


select * FROM medico